<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="1、简介Docker是一个开源的应用容器引擎；是一个轻量级容器技术； Docker支持将软件编译成一个镜像；然后在镜像中各种软件做好配置，将镜像发布出去，其他使用者可以直接使用这个镜像； 运行中的这个镜像称为容器，容器启动是非常快速的。   2、核心概念docker主机(Host)：安装了Docker程序的机器（Docker直接安装在操作系统之上）； docker客户端(Client)：连接doc">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2021/01/18/Docker/Docker/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="1、简介Docker是一个开源的应用容器引擎；是一个轻量级容器技术； Docker支持将软件编译成一个镜像；然后在镜像中各种软件做好配置，将镜像发布出去，其他使用者可以直接使用这个镜像； 运行中的这个镜像称为容器，容器启动是非常快速的。   2、核心概念docker主机(Host)：安装了Docker程序的机器（Docker直接安装在操作系统之上）； docker客户端(Client)：连接doc">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/FateCause/typoraPic/images/Docker%E5%9B%BE%E6%A0%87.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/FateCause/typoraPic/images/%E9%95%9C%E5%83%8F%E4%BB%8B%E7%BB%8D.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/FateCause/typoraPic/images/Docker%E5%85%B3%E7%B3%BB%E5%9B%BE.png">
<meta property="article:published_time" content="2021-01-18T11:01:37.242Z">
<meta property="article:modified_time" content="2021-01-15T10:56:46.351Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/FateCause/typoraPic/images/Docker%E5%9B%BE%E6%A0%87.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Docker/Docker" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/18/Docker/Docker/" class="article-date">
  <time class="dt-published" datetime="2021-01-18T11:01:37.242Z" itemprop="datePublished">2021-01-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="1、简介"><a href="#1、简介" class="headerlink" title="1、简介"></a>1、简介</h4><p><strong>Docker</strong>是一个开源的应用容器引擎；是一个轻量级容器技术；</p>
<p>Docker支持将软件编译成一个镜像；然后在镜像中各种软件做好配置，将镜像发布出去，其他使用者可以直接使用这个镜像；</p>
<p>运行中的这个镜像称为容器，容器启动是非常快速的。</p>
<p><img src="https://cdn.jsdelivr.net/gh/FateCause/typoraPic/images/Docker%E5%9B%BE%E6%A0%87.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/FateCause/typoraPic/images/%E9%95%9C%E5%83%8F%E4%BB%8B%E7%BB%8D.png"></p>
<h4 id="2、核心概念"><a href="#2、核心概念" class="headerlink" title="2、核心概念"></a>2、核心概念</h4><p>docker主机(Host)：安装了Docker程序的机器（Docker直接安装在操作系统之上）；</p>
<p>docker客户端(Client)：连接docker主机进行操作；</p>
<p>docker仓库(Registry)：用来保存各种打包好的软件镜像；</p>
<p>docker镜像(Images)：软件打包好的镜像；放在docker仓库中；</p>
<p>docker容器(Container)：镜像启动后的实例称为一个容器；容器是独立运行的一个或一组应用</p>
<p><img src="https://cdn.jsdelivr.net/gh/FateCause/typoraPic/images/Docker%E5%85%B3%E7%B3%BB%E5%9B%BE.png"></p>
<p>使用Docker的步骤：</p>
<p>1）、安装Docker</p>
<p>2）、去Docker仓库找到这个软件对应的镜像；</p>
<p>3）、使用Docker运行这个镜像，这个镜像就会生成一个Docker容器；</p>
<p>4）、对容器的启动停止就是对软件的启动停止；</p>
<h4 id="3、安装Docker"><a href="#3、安装Docker" class="headerlink" title="3、安装Docker"></a>3、安装Docker</h4><h5 id="1）、安装linux虚拟机"><a href="#1）、安装linux虚拟机" class="headerlink" title="1）、安装linux虚拟机"></a>1）、安装linux虚拟机</h5><p>​    1）、VMWare、VirtualBox（安装）；</p>
<p>​    2）、导入虚拟机文件centos7-atguigu.ova；</p>
<p>​    3）、双击启动linux虚拟机;使用  root/ 123456登陆</p>
<p>​    4）、使用客户端连接linux服务器进行命令操作；</p>
<p>​    5）、设置虚拟机网络；</p>
<p>​        桥接网络===选好网卡====接入网线；</p>
<p>​    6）、设置好网络以后使用命令重启虚拟机的网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service network restart</span><br></pre></td></tr></table></figure>
<p>​    7）、查看linux的ip地址</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr</span><br></pre></td></tr></table></figure>
<p>​    8）、使用客户端连接linux；</p>
<h5 id="2）、在linux虚拟机上安装docker"><a href="#2）、在linux虚拟机上安装docker" class="headerlink" title="2）、在linux虚拟机上安装docker"></a>2）、在linux虚拟机上安装docker</h5><p>步骤：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1、检查内核版本，必须是3.10及以上</span><br><span class="line">uname -r</span><br><span class="line">若内核版本太低yum update更新</span><br><span class="line">2、安装docker</span><br><span class="line">yum install docker</span><br><span class="line">3、输入y确认安装</span><br><span class="line">4、启动docker</span><br><span class="line">[root@localhost ~]# systemctl start docker</span><br><span class="line">[root@localhost ~]# docker -v</span><br><span class="line">Docker version 1.12.6, build 3e8e77d/1.12.6</span><br><span class="line">5、开机启动docker</span><br><span class="line">[root@localhost ~]# systemctl enable docker</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.</span><br><span class="line">6、停止docker</span><br><span class="line">systemctl stop docker</span><br><span class="line">7、查看docker状态</span><br><span class="line">systemctl status docker</span><br></pre></td></tr></table></figure>
<h4 id="4、配置阿里云镜像"><a href="#4、配置阿里云镜像" class="headerlink" title="4、配置阿里云镜像"></a>4、配置阿里云镜像</h4><p><a target="_blank" rel="noopener" href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">配置docker阿里镜像加速</a></p>
<p>按步骤指导配置阿里云镜像加速，以centos7为例执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">	1）sudo mkdir -p /etc/docker</span><br><span class="line">	若存在文件夹可跳过</span><br><span class="line"></span><br><span class="line">	2）sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://uw5moiq5.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">	3)sudo systemctl daemon-reload</span><br><span class="line">	4)sudo systemctl restart docker</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="5、Docker常用命令-amp-操作"><a href="#5、Docker常用命令-amp-操作" class="headerlink" title="5、Docker常用命令&amp;操作"></a>5、Docker常用命令&amp;操作</h4><h5 id="1）镜像操作"><a href="#1）镜像操作" class="headerlink" title="1）镜像操作"></a>1）镜像操作</h5><table>
<thead>
<tr>
<th>操作</th>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>检索</td>
<td>docker  search 关键字  eg：docker  search redis</td>
<td>我们经常去docker  hub上检索镜像的详细信息，如镜像的TAG。</td>
</tr>
<tr>
<td>拉取</td>
<td>docker pull 镜像名:tag</td>
<td>:tag是可选的，tag表示标签，多为软件的版本，默认是latest</td>
</tr>
<tr>
<td>列表</td>
<td>docker images</td>
<td>查看所有本地镜像</td>
</tr>
<tr>
<td>删除</td>
<td>docker rmi image-id</td>
<td>删除指定的本地镜像</td>
</tr>
</tbody></table>
<p><a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></p>
<p>docker pull下来的镜像：</p>
<p>​    /var/lib/docker/containers/镜像序号</p>
<p>​    进入image文件夹，里面有repositories.json的文件，详细记录了各镜像的一些信息</p>
<h5 id="2）容器操作"><a href="#2）容器操作" class="headerlink" title="2）容器操作"></a>2）容器操作</h5><p>软件镜像（QQ安装程序）—-运行镜像—-产生一个容器（正在运行的软件，运行的QQ）；</p>
<p>步骤：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">1、搜索镜像</span><br><span class="line">[root@localhost ~]# docker search tomcat</span><br><span class="line">2、拉取镜像</span><br><span class="line">[root@localhost ~]# docker pull tomcat:8.0.35 </span><br><span class="line">	tomcat8.0.35可以直接访问，更高版本的没有webapp无法直接访问</span><br><span class="line">3、根据镜像启动容器</span><br><span class="line">docker run --name mytomcat -d tomcat:latest</span><br><span class="line">4、docker ps  </span><br><span class="line">查看运行中的容器</span><br><span class="line">5、 停止运行中的容器</span><br><span class="line">docker stop  容器的id</span><br><span class="line">6、查看所有的容器</span><br><span class="line">docker ps -a</span><br><span class="line">7、启动容器</span><br><span class="line">docker start 容器id</span><br><span class="line">8、删除一个容器</span><br><span class="line"> docker rm 容器id</span><br><span class="line">9、启动一个做了端口映射的tomcat</span><br><span class="line">[root@localhost ~]# docker run -d -p 8888:8080 tomcat</span><br><span class="line">-d：后台运行</span><br><span class="line">-p: 将主机的端口映射到容器的一个端口    主机端口:容器内部的端口</span><br><span class="line"></span><br><span class="line">10、为了演示简单关闭了linux的防火墙</span><br><span class="line">service firewalld status ；查看防火墙状态</span><br><span class="line">service firewalld stop：关闭防火墙</span><br><span class="line">11、查看容器的日志</span><br><span class="line">docker logs container-name/container-id</span><br><span class="line">12、指定容器挂在路径</span><br><span class="line">docker -v</span><br><span class="line">13、指定容器启动的内存大小</span><br><span class="line">docker -m</span><br><span class="line"></span><br><span class="line">14、docker进入容器执行命令</span><br><span class="line">docker exec -it 容器id /bin/bash</span><br><span class="line"></span><br><span class="line">15、查看镜像的版本号</span><br><span class="line">docker image inspect nginx:latest | grep -i version</span><br><span class="line"></span><br><span class="line">16、centos7中Docker挂载主机目录，访问相应的文件出现Premission denied的权限访问问题，解决方法</span><br><span class="line">问题原因及解决办法</span><br><span class="line">   原因是CentOS7中的安全模块selinux把权限禁掉了，至少有以下三种方式解决挂载的目录没有权限的问题：</span><br><span class="line">   1.在运行容器的时候，给容器加特权，及加上 --privileged=true 参数：</span><br><span class="line">   docker run -i -t -v /soft:/soft --privileged=true 686672a1d0cc /bin/bash</span><br><span class="line">   2.临时关闭selinux：</span><br><span class="line">   setenforce 0</span><br><span class="line">   3.添加selinux规则，改变要挂载的目录的安全性文本</span><br><span class="line">   chcon -Rt svirt_sandbox_file_t 挂在文件夹</span><br><span class="line"></span><br><span class="line">17、允许容器之间互相通信</span><br><span class="line">docker network ls</span><br><span class="line">1)docker --link 容器名</span><br><span class="line">2)查看现在的网络:docker network ls</span><br><span class="line">	创建网络:docker network create test-network</span><br><span class="line">	启动容器时，加入创建的网络:docker run -it --network test-network --network-alias mysql  -e MYSQL_ROOT_PASSWORD=123 mysql:5.7</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">18、查看Docker的网络策略</span></span><br><span class="line">docker network ls</span><br><span class="line">Docker有三种网络模式，bridge、host、none，在你创建容器的时候，不指定--network默认是bridge。</span><br><span class="line">bridge：为每一个容器分配IP，并将容器连接到一个docker0虚拟网桥，通过docker0网桥与宿主机通信。也就是说，此模式下，你不能用宿主机的IP+容器映射端口来进行Docker容器之间的通信。</span><br><span class="line">host：容器不会虚拟自己的网卡，配置自己的IP，而是使用宿主机的IP和端口。这样一来，Docker容器之间的通信就可以用宿主机的IP+容器映射端口</span><br><span class="line">none：无网络。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">更多命令参看</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/docker/</span><br><span class="line">可以参考每一个镜像的文档</span><br></pre></td></tr></table></figure>
<h5 id="3）安装MySQL示例"><a href="#3）安装MySQL示例" class="headerlink" title="3）安装MySQL示例"></a>3）安装MySQL示例</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql</span><br><span class="line">	现有的navicat只支持访问mysql5.7，更高的不能访问</span><br></pre></td></tr></table></figure>
<p>错误的启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run --name mysql01 -d mysql</span><br><span class="line">42f09819908bb72dd99ae19e792e0a5d03c48638421fa64cce5f8ba0f40f5846</span><br><span class="line"></span><br><span class="line">mysql退出了</span><br><span class="line">[root@localhost ~]# docker ps -a</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                           PORTS               NAMES</span><br><span class="line">42f09819908b        mysql               &quot;docker-entrypoint.sh&quot;   34 seconds ago      Exited (1) 33 seconds ago                            mysql01</span><br><span class="line">538bde63e500        tomcat              &quot;catalina.sh run&quot;        About an hour ago   Exited (143) About an hour ago                       compassionate_</span><br><span class="line">goldstine</span><br><span class="line">c4f1ac60b3fc        tomcat              &quot;catalina.sh run&quot;        About an hour ago   Exited (143) About an hour ago                       lonely_fermi</span><br><span class="line">81ec743a5271        tomcat              &quot;catalina.sh run&quot;        About an hour ago   Exited (143) About an hour ago                       sick_ramanujan</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//错误日志</span><br><span class="line">[root@localhost ~]# docker logs 42f09819908b</span><br><span class="line">error: database is uninitialized and password option is not specified </span><br><span class="line">  You need to specify one of MYSQL_ROOT_PASSWORD, MYSQL_ALLOW_EMPTY_PASSWORD and MYSQL_RANDOM_ROOT_PASSWORD；这个三个参数必须指定一个</span><br></pre></td></tr></table></figure>
<p>正确的启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 -d mysql</span><br><span class="line">b874c56bec49fb43024b3805ab51e9097da779f2f572c22c695305dedd684c5f</span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br><span class="line">b874c56bec49        mysql               &quot;docker-entrypoint.sh&quot;   4 seconds ago       Up 3 seconds        3306/tcp            mysql01</span><br></pre></td></tr></table></figure>
<p>做了端口映射</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run -p 3306:3306 --name mysql02 -e MYSQL_ROOT_PASSWORD=123456 -d mysql</span><br><span class="line">ad10e4bc5c6a0f61cbad43898de71d366117d120e39db651844c0e73863b9434</span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">ad10e4bc5c6a        mysql               &quot;docker-entrypoint.sh&quot;   4 seconds ago       Up 2 seconds        0.0.0.0:3306-&gt;3306/tcp   mysql02</span><br></pre></td></tr></table></figure>
<p>几个其他的高级操作</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run --name mysql03 -v /conf/mysql:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag*</span><br><span class="line">把主机的/conf/mysql文件夹挂载到 mysqldocker容器的/etc/mysql/conf.d文件夹里面</span><br><span class="line">改mysql的配置文件就只需要把mysql配置文件放在自定义的文件夹下（/conf/mysql）</span><br><span class="line"></span><br><span class="line">docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci</span><br><span class="line">指定mysql的一些配置参数</span><br></pre></td></tr></table></figure>
<h5 id="4）安装ElasticSearch"><a href="#4）安装ElasticSearch" class="headerlink" title="4）安装ElasticSearch"></a>4）安装ElasticSearch</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32101993/article/details/100021002">docker安装ElasticSearch详解</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、搜索镜像</span><br><span class="line">docker search elasticsearch</span><br><span class="line"></span><br><span class="line">2、下载镜像</span><br><span class="line">docker pull docker.io/elasticsearch:版本号</span><br><span class="line"></span><br><span class="line">3、启动容器</span><br><span class="line">docker run -d --name myes -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot; 5acf0e8da90b</span><br><span class="line"></span><br><span class="line">-e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;调整分配内存</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="5）安装Nacos"><a href="#5）安装Nacos" class="headerlink" title="5）安装Nacos"></a>5）安装Nacos</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1、搜索镜像</span><br><span class="line">docker search nacos/nacos-server:版本号</span><br><span class="line"></span><br><span class="line">2、docker pull nacos/nacos-server:版本号</span><br><span class="line"></span><br><span class="line">3、创建配置文件并添加配置</span><br><span class="line">mkdir nacos/init.d</span><br><span class="line">touch custom.properties</span><br><span class="line">vi配置文件并写入：management.endpoints.web.exposure.include=*</span><br><span class="line"></span><br><span class="line">4、使用standalone模式并开放8848端口，并映射配置文件和日志目录，数据库默认使用 Derby</span><br><span class="line"><span class="meta">$</span><span class="bash"> docker run -d -p 8848:8848 -e MODE=standalone -v /opt/nacos/init.d/custom.properties:/root/nacos/init.d/custom.properties -v /opt/nacos/logs:/root/nacos/logs --restart always --name nacos-1.1.4 nacos/nacos-server:1.1.4</span></span><br><span class="line"></span><br><span class="line">5、测试访问</span><br><span class="line">直接访问 http://127.0.0.1:8848/nacos， 使用账号：nacos，密码：nacos 直接登录。nacos是默认账号和密码，登录成功后可以修改密码。</span><br></pre></td></tr></table></figure>
<h5 id="6）安装neo4j"><a href="#6）安装neo4j" class="headerlink" title="6）安装neo4j"></a>6）安装neo4j</h5><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/caoyusang/p/13610408.html">参考链接地址</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、拉取指定版本的镜像</span></span><br><span class="line">docker pull neo4j:3.5.8</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2、创建是个映射文件夹</span></span><br><span class="line">data——数据存放的文件夹</span><br><span class="line">logs——运行的日志文件夹</span><br><span class="line">conf——数据库配置文件夹（在配置文件neo4j.conf中配置包括开放远程连接、设置默认激活的数据库）</span><br><span class="line">import——为了大批量导入csv来构建数据库，需要导入的节点文件nodes.csv和关系文件rel.csv需要放到这个文件夹下）</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">3、启动neo4j容器并挂载目录</span></span><br><span class="line">docker run -d --name neo4j-3.5.8 -p 7474:7474 -p 7687:7687 -v $HOME/neo4j/data:/var/lib/neo4j/data -v $HOME/neo4j/logs:/var/lib/neo4j/logs -v $HOME/neo4j/conf:/var/lib/neo4j/conf -v $HOME/neo4j/import:/var/lib/neo4j/import --env NEO4J_AUTH=neo4j/yjb123456 --privileged=true neo4j:3.5.8</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#给容器添加挂载目录的权限：--privileged=true</span></span> </span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#给neo4j设置了密码：NEO4J_AUTH=neo4j/yjb123456</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2、创建jenkins挂在的目录并修改权限</span></span><br><span class="line">docker run -ti --rm --entrypoint=&quot;/bin/bash&quot; neo4j:3.5.8 -c &quot;id neo4j&quot;</span><br><span class="line">chown -R 101 $HOME/neo4j</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">4、添加selinux规则，改变要挂载的目录的安全性文本</span></span><br><span class="line">chcon -Rt svirt_sandbox_file_t $HOME/neo4j</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">5、neo4j配置，视情况是否必要</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入容器配置目录挂载在宿主机的对应目录，我这里是/home/neo4j/conf</span></span><br><span class="line">cd /home/neo4j/conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> vim编辑器打开neo4j.conf</span></span><br><span class="line">vim neo4j.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进行以下更改</span></span><br><span class="line"><span class="meta">#</span><span class="bash">在文件配置末尾添加这一行</span></span><br><span class="line">dbms.connectors.default_listen_address=0.0.0.0  //指定连接器的默认监听ip为0.0.0.0，即允许任何ip连接到数据库</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#修改</span></span></span><br><span class="line">dbms.connector.bolt.listen_address=0.0.0.0:7687  //取消注释并把对bolt请求的监听“地址:端口”改为“0.0.0.0:7687”</span><br><span class="line">dbms.connector.http.listen_address=0.0.0.0:7474  //取消注释并把对http请求的监听“地址:端口”改为“0.0.0.0:7474”</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">6、查看当前防火墙状态，若为“inactive”，则防火墙已关闭，不必进行接续操作。</span></span><br><span class="line">service firewalld status</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 若防火墙状态为“active”，则使用下列命令开放端口</span></span><br><span class="line">sudo ufw allow 7474</span><br><span class="line">sudo ufw allow 7687</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">重启防火墙</span></span><br><span class="line">sudo ufw reload</span><br></pre></td></tr></table></figure>
<h5 id="7）安装Jenkins"><a href="#7）安装Jenkins" class="headerlink" title="7）安装Jenkins"></a>7）安装Jenkins</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">如果你看过 Jenkins 文档中 Docker 安装 小节，会发现官方推荐使用的镜像是jenkinsci/blueocean，该镜像包含当前的长期支持 (LTS) 的 Jenkins 版本 (可以生产使用) ，并捆绑了所有 Blue Ocean 插件和功能。如果使用的是jenkins镜像，其集成的 Jenkins 版本比较高，结果出现好多插件不兼容的情况，对于我等小白来说是一件比较麻烦的事。</span><br><span class="line"><span class="meta">#</span><span class="bash">1、拉取指定版本的镜像</span></span><br><span class="line">docker pull jenkinsci/blueocean:版本号</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2、创建jenkins挂在的目录并修改权限</span></span><br><span class="line">mkdir -p $HOME/jenkins_home</span><br><span class="line"><span class="meta">#</span><span class="bash">查看jenkins用户</span></span><br><span class="line">docker run -ti --rm --entrypoint=&quot;/bin/bash&quot; jenkinsci/blueocean -c &quot;id jenkins&quot;	</span><br><span class="line">chown -R 1000 $HOME/jenkins_home</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">4、添加selinux规则，改变要挂载的目录的安全性文本</span></span><br><span class="line">chcon -Rt svirt_sandbox_file_t /root/jenkins_home</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">4、启动jenkins容器并挂载目录,若不挂载目录，容器销毁数据会全部丢失</span></span><br><span class="line">docker run --name jenkinsci-blueocean -d -p 50001:8080 -p 50000:50000 -v $HOME/jenkins_home:/var/jenkins_home \</span><br><span class="line">-v /var/run/docker.sock:/var/run/docker.sock jenkinsci/blueocean:版本号</span><br><span class="line"><span class="meta">#</span><span class="bash"> Tips：8080 端口用来公开访问 Web 界面，50000 端口允许访问远程 Java (JIRA) API</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">5、以上如果一切正常，现在就可以通过http://&lt;ipaddress&gt;:8080访问 Jenkins 的 Web 界面</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">6、查看管理员密码，管理员初始密码被放到了/var/jenkins_home/secrets/initialAdminPassword 文件中，需进入容器内部查看</span></span><br><span class="line">docker exec -it jenkinsci-blueocean /bin/bash -c &quot;cat /var/jenkins_home/secrets/initialAdminPassword&quot;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker执行权限的操作</span></span><br><span class="line">docker run -ti --rm --entrypoint=&quot;/bin/bash&quot; jenkinsci/blueocean -c &quot;whoami &amp;&amp; id&quot;</span><br><span class="line">docker run -ti --rm --entrypoint=&quot;/bin/bash&quot; jenkinsci/blueocean -c &quot;ls -la /var/jenkins_home&quot;</span><br><span class="line">docker run -ti --rm -v /root/jenkins_home:/var/jenkins_home --entrypoint=&quot;/bin/bash&quot; jenkinsci/blueocean -c &quot;ls -la /var/jenkins_home&quot;</span><br></pre></td></tr></table></figure>
<h5 id="8）安装WordPress"><a href="#8）安装WordPress" class="headerlink" title="8）安装WordPress"></a>8）安装WordPress</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、拉取指定版本的镜像</span></span><br><span class="line">docker pull wordpress:版本号</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2、启动WordPress容器设置依赖的mysql地址</span></span><br><span class="line">docker run -it -e WORDPRESS_DB_HOST=192.168.80.129:3306 -e WORDPRESS_DB_USESR=root -e WORDPRESS_DB_PASSWORD=123456 -p 8080:80 -d wordpress:版本号</span><br></pre></td></tr></table></figure>
<h5 id="9）安装zookeeper"><a href="#9）安装zookeeper" class="headerlink" title="9）安装zookeeper"></a>9）安装zookeeper</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、下载zookeeper镜像，wurstmeister/zookeeper版本比较旧但配置比较全，zookeeper版本比较全缺少配置</span></span><br><span class="line">docker pull wurstmeister/zookeeper</span><br><span class="line">docker pull zookeeper:3.5.8</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2、创建zookeeper挂在的目录并修改权限</span></span><br><span class="line">mkdir -p $HOME/zookeeper</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看zookeeper用户</span></span><br><span class="line">docker run -ti --rm --entrypoint=&quot;/bin/bash&quot; zookeeper:3.5.8 -c &quot;id zookeeper&quot;</span><br><span class="line">chown -R 1001 $HOME/zookeeper</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2、启动zookeeper容器</span></span><br><span class="line">docker run -itd --name zookeeper-3.5.8 -p 2181:2181 -v /etc/localtime:/etc/localtime -v  zookeeper:3.5.8</span><br><span class="line">docker run -itd --name zookeeper -p 2181:2181 -v /etc/localtime:/etc/localtime -v  wurstmeister/zookeeper</span><br></pre></td></tr></table></figure>
<h5 id="10）安装kafka"><a href="#10）安装kafka" class="headerlink" title="10）安装kafka"></a>10）安装kafka</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、下载和安装zookeeper镜像</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2、下载kafka镜像</span></span><br><span class="line">docker pull wurstmeister/kafka</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">3、启动kafka容器</span></span><br><span class="line">docker run  -d --name kafka -p 9092:9092 --link zookeeper-3.5.6 -e KAFKA_BROKER_ID=0 -e KAFKA_ZOOKEEPER_CONNECT=192.168.56.80:2181 -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://192.168.56.80:9092 -e KAFKA_LISTENERS=PLAINTEXT://0.0.0.0:9092 -t wurstmeister/kafka</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">4、测试消息</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="6、卸载docker"><a href="#6、卸载docker" class="headerlink" title="6、卸载docker"></a>6、卸载docker</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kingsonfu/p/11582495.html">卸载docker步骤</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/18/Docker/Docker/" data-id="ckk2gq3ud001jz8pqbf4iemw7" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/01/18/ElasticSearch/ES%E5%AE%9E%E7%8E%B0%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2021/01/18/DevOps/DevOps/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/01/18/%E4%BA%91%E8%AE%A1%E7%AE%97/%E4%BA%91%E8%AE%A1%E7%AE%97%E5%B8%B8%E8%A7%81%E6%A6%82%E5%BF%B5/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/01/18/%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81/03_Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/01/18/%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81/02_RabbitMQ%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/01/18/%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81/01_%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E7%9A%84%E6%96%B9%E6%A1%88%E4%BB%8B%E7%BB%8D/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/01/18/%E5%85%B6%E4%BB%96%E5%B0%8F%E6%8A%80%E5%B7%A7/github%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6%E5%A4%AA%E6%85%A2/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>